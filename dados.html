<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Clientes - Vó Marya</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#fff0f0;color:#333;}
.header{background:#ff4d4d;color:#fff;padding:1.5rem;text-align:center;box-shadow:0 4px 6px rgba(0,0,0,0.2);}
.header h1{margin:0;font-size:1.8rem;}
.main{padding:2rem;display:flex;flex-direction:column;align-items:center;}
.card{background:#fff;padding:1.5rem 2rem;margin:1rem 0;border-radius:12px;box-shadow:0 3px 10px rgba(0,0,0,0.2);width:100%;max-width:700px;}
.card h2{margin-top:0;color:#ff4d4d;}
input,select{width:100%;padding:0.7rem;margin:0.5rem 0;border-radius:6px;border:1px solid #ccc;font-size:1rem;}
button{padding:0.7rem 1rem;background:#ff4d4d;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:1rem;margin-top:0.5rem;transition:0.2s;}
button:hover{background:#e60000;}
table{width:100%;border-collapse:collapse;margin-top:1rem;font-size:0.95rem;}
th,td{text-align:left;padding:0.5rem;border:1px solid #ccc;}
th{background:#ff9999;}
.alert{padding:0.7rem 1rem;margin-top:0.5rem;border-radius:6px;text-align:center;display:none;}
.alert.success{background:#d4edda;color:#155724;}
.alert.error{background:#f8d7da;color:#721c24;}
canvas{margin-top:1rem;background:#fff5f5;border:1px solid #ccc;border-radius:6px;}
@media(max-width:500px){input,button{font-size:0.9rem;}}
</style>
</head>
<body>

<div class="header">
<h1>Dashboard Clientes - Shopping Marya</h1>
</div>

<div class="main">

<div class="card">
<h2>Adicionar Cliente</h2>
<input id="name" placeholder="Nome do cliente">
<input id="debt" type="number" placeholder="Quanto deve (R$)">
<input id="pay" type="number" placeholder="Quanto já pagou (R$)">
<input id="installments" type="number" placeholder="Parcelas">
<button id="addBtn">Adicionar</button>
<div id="msg" class="alert"></div>
</div>

<div class="card">
<h2>Resumo Geral</h2>
<p>Total Dívidas: R$ <span id="totalDebt">0.00</span></p>
<p>Total Pago: R$ <span id="totalPay">0.00</span></p>
<p>Parcelas Restantes: <span id="totalInstallments">0</span></p>
<canvas id="chart" width="600" height="200"></canvas>
</div>

<div class="card">
<h2>Lista de Clientes</h2>
<table>
<thead>
<tr>
<th>Nome</th>
<th>Deve (R$)</th>
<th>Paga (R$)</th>
<th>Parcelas</th>
<th>Ações</th>
</tr>
</thead>
<tbody id="clientList"></tbody>
</table>
</div>

</div>

<script>
// LocalStorage
function getClients(){return JSON.parse(localStorage.getItem('clients')||'[]');}
function saveClients(clients){localStorage.setItem('clients',JSON.stringify(clients));}

// Alertas
function showMsg(text,type){
  const msg=document.getElementById('msg');
  msg.textContent=text;
  msg.className='alert '+(type==='success'?'success':'error');
  msg.style.display='block';
  setTimeout(()=>{msg.style.display='none';},2000);
}

// Dashboard
function updateDashboard(){
  const clients=getClients();
  let totalDebt=0,totalPay=0,totalInstallments=0;
  clients.forEach(c=>{totalDebt+=c.debt;totalPay+=c.pay;totalInstallments+=c.installments;});
  document.getElementById('totalDebt').textContent=totalDebt.toFixed(2);
  document.getElementById('totalPay').textContent=totalPay.toFixed(2);
  document.getElementById('totalInstallments').textContent=totalInstallments;

  drawChart(totalDebt,totalPay);
}

// Desenhar gráfico simples
function drawChart(debt,pay){
  const canvas=document.getElementById('chart');
  const ctx=canvas.getContext('2d');
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const total=Math.max(debt,pay);
  const debtHeight=(debt/total)*150;
  const payHeight=(pay/total)*150;

  // Dívida
  ctx.fillStyle='#ff4d4d';
  ctx.fillRect(150,160-debtHeight,100,debtHeight);
  ctx.fillStyle='#000';
  ctx.fillText('Dívida',175,175);

  // Pago
  ctx.fillStyle='#4CAF50';
  ctx.fillRect(350,160-payHeight,100,payHeight);
  ctx.fillStyle='#000';
  ctx.fillText('Pago',375,175);
}

// Tabela
function updateTable(){
  const tbody=document.getElementById('clientList');
  tbody.innerHTML='';
  const clients=getClients();
  clients.forEach((c,index)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${c.name}</td>
                  <td>R$ ${c.debt.toFixed(2)}</td>
                  <td>R$ ${c.pay.toFixed(2)}</td>
                  <td>${c.installments}</td>
                  <td>
                    <button onclick="editClient(${index})">Editar</button>
                    <button onclick="removeClient(${index})">Remover</button>
                  </td>`;
    tbody.appendChild(tr);
  });
}

// Adicionar cliente
document.getElementById('addBtn').addEventListener('click',()=>{
  const name=document.getElementById('name').value.trim();
  const debt=parseFloat(document.getElementById('debt').value);
  const pay=parseFloat(document.getElementById('pay').value);
  const installments=parseInt(document.getElementById('installments').value);

  if(!name||isNaN(debt)||isNaN(pay)||isNaN(installments)){
    showMsg('Preencha todos os campos corretamente!','error'); return;
  }

  const clients=getClients();
  clients.push({name,debt,pay,installments});
  saveClients(clients);

  document.getElementById('name').value='';
  document.getElementById('debt').value='';
  document.getElementById('pay').value='';
  document.getElementById('installments').value='';
  updateTable();
  updateDashboard();
  showMsg('Cliente adicionado!','success');
});

// Remover cliente
function removeClient(index){
  const clients=getClients();
  if(confirm(`Remover ${clients[index].name}?`)){
    clients.splice(index,1);
    saveClients(clients);
    updateTable();
    updateDashboard();
    showMsg('Cliente removido!','success');
  }
}

// Editar cliente
function editClient(index){
  const clients=getClients();
  const c=clients[index];
  const name=prompt('Nome:',c.name);
  const debt=parseFloat(prompt('Quanto deve (R$):',c.debt));
  const pay=parseFloat(prompt('Quanto já pagou (R$):',c.pay));
  const installments=parseInt(prompt('Parcelas:',c.installments));
  if(name && !isNaN(debt) && !isNaN(pay) && !isNaN(installments)){
    clients[index]={name,debt,pay,installments};
    saveClients(clients);
    updateTable();
    updateDashboard();
    showMsg('Cliente editado!','success');
  }
}

// Inicializar
updateTable();
updateDashboard();
</script>

</body>
</html>
